"use strict";angular.module("slatwalladmin").controller("alertController",["$scope","alertService",function(e,t){e.$id="alertController",e.alerts=t.getAlerts()}]),angular.module("slatwalladmin").controller("collections",["$scope","$location","$log","$timeout","$slatwall","collectionService","metadataService","paginationService",function(e,t,r,i,o,l,n,a){e.$id="collectionsController";var d=function(){for(var e={},t=window.location.search.substring(1),r=t.split("&"),i=0;i<r.length;i++){var o=r[i].split("=");if("undefined"==typeof e[o[0]])e[o[0]]=o[1];else if("string"==typeof e[o[0]]){var l=[e[o[0]],o[1]];e[o[0]]=l}else e[o[0]].push(o[1])}return e}();e.collectionID=d.collectionID,e.currentPage=a.getCurrentPage(),e.pageShow=a.getPageShow(),e.pageStart=a.getPageStart,e.pageEnd=a.getPageEnd,e.recordsCount=a.getRecordsCount,e.autoScrollPage=1,e.autoScrollDisabled=!1,e.appendToCollection=function(){if("Auto"===e.pageShow&&(r.debug("AppendToCollection"),e.autoScrollPage<e.collection.totalPages)){e.autoScrollDisabled=!0,e.autoScrollPage++;var t=o.getEntity("collection",{id:e.collectionID,currentPage:e.autoScrollPage,pageShow:50});t.then(function(t){e.collection.pageRecords=e.collection.pageRecords.concat(t.pageRecords),e.autoScrollDisabled=!1},function(e){})}},e.keywords="",e.loadingCollection=!1;var s;e.searchCollection=function(t){s&&i.cancel(s),s=i(function(){r.debug("search with keywords"),r.debug(e.keywords),a.setCurrentPage(1),e.loadingCollection=!0,e.getCollection()},500)},e.getCollection=function(){var t=50;"Auto"!==e.pageShow&&(t=e.pageShow);var r=o.getEntity("collection",{id:e.collectionID,currentPage:e.currentPage,pageShow:t,keywords:e.keywords});r.then(function(t){e.collection=t,e.collectionInitial=angular.copy(e.collection),angular.isUndefined(e.collectionConfig)&&(e.collectionConfig=angular.fromJson(e.collection.collectionConfig)),angular.isUndefined(e.collectionConfig.filterGroups)&&(e.collectionConfig.filterGroups=[{filterGroup:[]}]),l.setFilterCount(p()),e.loadingCollection=!1},function(e){})},e.getCollection();var u=e.$watch("collection",function(t,r){if(t!==r){if(angular.isUndefined(e.filterPropertiesList)){e.filterPropertiesList={};var i=o.getFilterPropertiesByBaseEntityName(e.collectionConfig.baseEntityAlias);i.then(function(t){n.setPropertiesList(t,e.collectionConfig.baseEntityAlias),e.filterPropertiesList[e.collectionConfig.baseEntityAlias]=n.getPropertiesListByBaseEntityAlias(e.collectionConfig.baseEntityAlias),n.formatPropertiesList(e.filterPropertiesList[e.collectionConfig.baseEntityAlias],e.collectionConfig.baseEntityAlias)})}u()}});e.setCollectionForm=function(t){e.collectionForm=t},e.collectionDetails={isOpen:!1,openCollectionDetails:function(){e.collectionDetails.isOpen=!0}},e.errorMessage={};var p=function(t){var r=0;angular.isDefined(t)||(t=e.collectionConfig.filterGroups[0].filterGroup);for(var i in t)if(t[i].$$isNew||angular.isDefined(t[i].filterGroup)){if(!angular.isDefined(t[i].filterGroup))break;r+=p(t[i].filterGroup)}else r++;return r};e.saveCollection=function(){i(function(){r.debug("saving Collection");var t="collection",i=e.collection;if(r.debug(e.collectionConfig),c(e.collectionForm)){var n=l.stringifyJSON(e.collectionConfig);r.debug(n);var d=angular.copy(i);d.collectionConfig=n,delete d.pageRecords;var s=o.saveEntity(t,i.collectionID,d);s.then(function(t){e.errorMessage={},a.setCurrentPage(1),e.getCollection(),e.collectionDetails.isOpen=!1},function(t){angular.forEach(t.errors,function(t,r){e.collectionForm[r].$invalid=!0,e.errorMessage[r]=t[0]})})}l.setFilterCount(p())})};var c=function(t){r.debug("validateForm");var i=!0;for(var o in t)if("$"!=o[0]){if(t[o].$invalid){i=!1;for(var l in t[o].$error)"required"==l&&(e.errorMessage[o]="This field is required")}t[o].$pristine&&t[o].$setViewValue(angular.isUndefined(t[o].$viewValue)?"":t[o].$viewValue)}return i};e.copyExistingCollection=function(){e.collection.collectionConfig=e.selectedExistingCollection},e.setSelectedExistingCollection=function(t){e.selectedExistingCollection=t},e.setSelectedFilterProperty=function(t){e.selectedFilterProperty=t},e.filterCount=l.getFilterCount}]),angular.module("slatwalladmin").controller("collectionsTabController",["$scope",function(e){}]),angular.module("slatwalladmin").controller("confirmationController",["$scope","$log","$modalInstance",function(e,t,r){e.deleteEntity=function(r){t.debug("Deleting an entity."),t.debug(e.entity),this.close()},e.close=function(){r.close()},e.cancel=function(){r.dismiss("cancel")}}]),angular.module("slatwalladmin").controller("create-bundle-controller",["$scope","$location","$log","$rootScope","$window","$slatwall","dialogService","alertService","productBundleService","formService","partialsPath",function(e,t,r,i,o,l,n,a,d,s,u){function p(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),r=t.exec(location.search);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))}e.partialsPath=u,e.$id="create-bundle-controller",angular.isDefined(e.scrollToTopOfDialog)&&e.scrollToTopOfDialog();var c=p("productID"),m=function(){e.product=l.newProduct();var t=l.newBrand(),r=l.newProductType();e.product.$$setBrand(t),e.product.$$setProductType(r),e.product.$$addSku(),e.product.data.skus[0].data.productBundleGroups=[]};if(e.productBundleGroup,angular.isDefined(c)&&""!==c){var f=l.getProduct({id:c});f.promise.then(function(){r.debug(f.value),f.value.$$getSkus().then(function(){f.value.data.skus[0].$$getProductBundleGroups().then(function(){e.product=f.value,angular.forEach(e.product.data.skus[0].data.productBundleGroups,function(e){e.$$getProductBundleGroupType(),d.decorateProductBundleGroup(e),e.data.$$editing=!1})})})},m())}else m();e.saveProductBundle=function(t){e.newSaving=!0,r.debug(e.newSaving),e.dIndex=t,e.product.$$save().then(function(){r.debug("Turn off the loader after saving."),e.newSaving=!1,angular.isDefined(e.dIndex)&&(e.closeSaving=!0,i.closePageDialog(e.dIndex))})}}]),angular.module("slatwalladmin").controller("globalSearch",["$scope","$log","$window","$timeout","$slatwall",function(e,t,r,i,o){e.keywords="",e.searchResultsOpen=!1,e.sidebarClass="sidebar",e.loading=!1,e.resultsFound=!0,e.searchResults={product:{title:"Products",resultNameFilter:function(e){return e.productName},results:[],id:function(e){return e.productID}},brand:{title:o.getRBKey("entity.Brands"),resultNameFilter:function(e){return e.brandName},results:[],id:function(e){return e.brandID}},account:{title:"Accounts",resultNameFilter:function(e){return e.firstName+" "+e.lastName},results:[],id:function(e){return e.accountID}},vendor:{title:"Vendors",resultNameFilter:function(e){return e.vendorName},results:[],id:function(e){return e.vendorID}}};var l,n=0;e.updateSearchResults=function(){e.loading=!0,e.showResults(),l&&i.cancel(l),l=i(function(){if(""===e.keywords)e.hideResults();else{e.showResults(),n=Object.keys(e.searchResults).length;for(var t in e.searchResults)(function(t){var r=o.getEntity(t,{keywords:e.keywords,pageShow:4,deferkey:"global-search-"+t});r.then(function(r){e.searchResults[t].results=[],e.searchResults[t].title=o.getRBKey("entity."+t.toLowerCase()+"_plural");for(var i in r.pageRecords)e.searchResults[t].results.push({name:e.searchResults[t].resultNameFilter(r.pageRecords[i]),link:"?slatAction=entity.detail"+t+"&"+t+"ID="+e.searchResults[t].id(r.pageRecords[i])});if(n--,0==n){e.loading=!1;var l=!1;for(var a in e.searchResults)if(e.searchResults[a].results.length){l=!0;break}e.resultsFound=l}})})(t)}},500)},e.showResults=function(){e.searchResultsOpen=!0,e.sidebarClass="sidebar s-search-width",r.onclick=function(t){var r=t.target.parentElement.offsetParent.classList.contains("sidebar");r||(e.hideResults(),e.$apply())}},e.hideResults=function(){e.searchResultsOpen=!1,e.sidebarClass="sidebar",e.search.$setPristine(),e.keywords="",r.onclick=null,e.loading=!1,e.resultsFound=!0;for(var t in e.searchResults)e.searchResults[t].results=[]}}]),angular.module("slatwalladmin").controller("pageDialog",["$scope","$location","$log","$anchorScroll","$slatwall","dialogService",function(e,t,r,i,o,l){e.$id="pageDialogController",e.pageDialogs=l.getPageDialogs(),e.scrollToTopOfDialog=function(){t.hash("/#topOfPageDialog"),i()},e.pageDialogStyle={"z-index":3e3}}]),angular.module("slatwalladmin").controller("preprocessaccount_addaccountpayment",["$scope","$compile",function(e,t){var r={aptCharge:"444df32dd2b0583d59a19f1b77869025",aptCredit:"444df32e9b448ea196c18c66e1454c46",aptAdjustment:"68e3fb57d8102b47acc0003906d16ddd"};e.totalAmountToApply=0,e.paymentTypeName=$.slatwall.rbKey("define.charge"),e.paymentTypeLock=!0,e.amount=0,e.updatePaymentType=function(){angular.forEach(e.appliedOrderPayment,function(t,i){e.paymentType!=r.aptAdjustment&&(t.paymentType=e.paymentType)}),e.paymentType==r.aptCharge?(e.paymentTypeName=$.slatwall.rbKey("define.charge"),e.paymentTypeLock=!0):e.paymentType==r.aptCredit?(e.paymentTypeName=$.slatwall.rbKey("define.credit"),e.paymentTypeLock=!0):e.paymentType==r.aptAdjustment&&(e.paymentTypeLock=!1,e.paymentTypeName=$.slatwall.rbKey("define.adjustment"),e.amount=0),e.updateSubTotal()},e.updateSubTotal=function(){e.totalAmountToApply=0,angular.forEach(e.appliedOrderPayment,function(t,i){void 0==t.amount||isNaN(t.amount)||(e.paymentType==r.aptCharge||e.paymentType==r.aptAdjustment?t.paymentType==r.aptCharge?e.totalAmountToApply+=parseFloat(t.amount):t.paymentType==r.aptCredit&&(e.totalAmountToApply-=parseFloat(t.amount)):e.paymentType==r.aptCredit&&(t.paymentType==r.aptCharge?e.totalAmountToApply-=parseFloat(t.amount):t.paymentType==r.aptCredit&&(e.totalAmountToApply+=parseFloat(t.amount))))}),e.amountUnapplied=Math.round(100*(e.amount-e.totalAmountToApply))/100,e.accountBalanceChange=parseFloat(e.amount),e.paymentType==r.aptCharge?e.accountBalanceChange=parseFloat(-1*e.accountBalanceChange):e.paymentType==r.aptAdjustment&&(e.accountBalanceChange+=parseFloat(e.amountUnapplied))}}]),angular.module("slatwalladmin").controller("routerController",["$scope","$routeParams","$location","$log","partialsPath","baseURL",function(e,t,r,i,o,l){e.$id="routerController",e.partialRoute="",i.debug(t),i.debug(r);var n=r.path();e.controllerType=n.split("/")[1];"entity"===e.controllerType&&(e.entityName=t.entityName,angular.isDefined(t.entityID)&&(e.entityID=t.entityID||""))}]),angular.module("slatwalladmin").directive("swChildOrderItem",["$log","$http","$compile","$templateCache","$slatwall","partialsPath",function(e,t,r,i,o,l){return{restrict:"A",scope:{orderItem:"=",orderId:"@",childOrderItems:"=",attributes:"="},templateUrl:l+"childorderitem.html",link:function(e,t,r){var i=[{isDeletable:!1,isExportable:!0,propertyIdentifier:"_orderitem.orderItemID",ormtype:"id",isVisible:!0,isSearchable:!0,title:"Order Item ID"},{title:"Order Item Type",propertyIdentifier:"_orderitem.orderItemType",isVisible:!0,isDeletable:!0},{title:"Order Item Price",propertyIdentifier:"_orderitem.price",isVisible:!0,isDeletable:!0},{title:"Sku Name",propertyIdentifier:"_orderitem.sku.skuName",isVisible:!0,isDeletable:!0},{title:"Sku Price",propertyIdentifier:"_orderitem.skuPrice",isVisible:!0,isDeletable:!0},{title:"Sku ID",propertyIdentifier:"_orderitem.sku.skuID",isVisible:!0,isDeletable:!0},{title:"SKU Code",propertyIdentifier:"_orderitem.sku.skuCode",isVisible:!0,isDeletable:!0},{title:"Product ID",propertyIdentifier:"_orderitem.sku.product.productID",isVisible:!0,isDeletable:!0},{title:"Product Name",propertyIdentifier:"_orderitem.sku.product.productName",isVisible:!0,isDeletable:!0},{title:"Product Description",propertyIdentifier:"_orderitem.sku.product.productDescription",isVisible:!0,isDeletable:!0},{title:"Image File Name",propertyIdentifier:"_orderitem.sku.imageFile",isVisible:!0,isDeletable:!0},{propertyIdentifier:"_orderitem.sku.skuPrice",ormtype:"string"},{title:"Product Type",propertyIdentifier:"_orderitem.sku.product.productType",isVisible:!0,isDeletable:!0},{propertyIdentifier:"_orderitem.sku.baseProductType",persistent:!1},{title:"Qty.",propertyIdentifier:"_orderitem.quantity",isVisible:!0,isDeletable:!0},{title:"Fulfillment Method Name",propertyIdentifier:"_orderitem.orderFulfillment.fulfillmentMethod.fulfillmentMethodName",isVisible:!0,isDeletable:!0},{title:"Fulfillment ID",propertyIdentifier:"_orderitem.orderFulfillment.orderFulfillmentID",isVisible:!0,isDeletable:!0},{title:"Fulfillment Method Type",propertyIdentifier:"_orderitem.orderFulfillment.fulfillmentMethod.fulfillmentMethodType",isVisible:!0,isDeletable:!0},{propertyIdentifier:"_orderitem.orderFulfillment.pickupLocation.primaryAddress.address",isVisible:!0,isDeletable:!0},{title:"Street Address",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.streetAddress",isVisible:!0,isDeletable:!0},{title:"Street Address 2",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.street2Address",isVisible:!0,isDeletable:!0},{title:"Postal Code",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.postalCode",isVisible:!0,isDeletable:!0},{title:"City",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.city",isVisible:!0,isDeletable:!0},{title:"State",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.stateCode",isVisible:!0,isDeletable:!0},{title:"Country",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.countryCode",isVisible:!0,isDeletable:!0},{title:"Total",propertyIdentifier:"_orderitem.itemTotal",persistent:!1},{title:"Discount Amount",propertyIdentifier:"_orderitem.discountAmount",persistent:!1},{propertyIdentifier:"_orderitem.extendedPrice",persistent:!1},{propertyIdentifier:"_orderitem.productBundleGroup.amount"},{title:"Product Bundle Group",propertyIdentifier:"_orderitem.productBundleGroup.productBundleGroupID",isVisible:!0,isDeletable:!0},{propertyIdentifier:"_orderitem.productBundleGroup.amountType"},{propertyIdentifier:"_orderitem.productBundleGroupPrice",persistent:!1},{propertyIdentifier:"_orderitem.productBundlePrice",persistent:!1}];angular.forEach(e.attributes,function(e){var t={propertyIdentifier:"_orderitem."+e.attributeCode,attributeID:e.attributeID,attributeSetObject:"orderItem"};i.push(t)});var l=[{filterGroup:[{propertyIdentifier:"_orderitem.parentOrderItem.orderItemID",comparisonOperator:"=",value:e.orderItem.$$getID()}]}],n={columnsConfig:angular.toJson(i),filterGroupsConfig:angular.toJson(l),allRecords:!0};e.hideChildren=function(t){angular.forEach(e.childOrderItems,function(t){console.dir(t),t.hide=!t.hide,e.orderItem.clicked=!e.orderItem.clicked})},e.getChildOrderItems=function(t){if(t.clicked=!0,!e.orderItem.childItemsRetrieved){e.orderItem.childItemsRetrieved=!0;var r=o.getEntity("orderItem",n);r.then(function(r){var l={};l.columns=i,l.baseEntityName="SlatwallOrderItem",l.baseEntityAlias="_orderitem";var n=o.populateCollection(r.records,l);angular.forEach(n,function(r){r.hide=!1,r.depth=t.depth+1,r.data.parentOrderItem=t,r.data.parentOrderItemQuantity=e.orderItem.data.quantity/e.orderItem.data.parentOrderItemQuantity,e.childOrderItems.splice(e.childOrderItems.indexOf(t)+1,0,r),r.data.productBundleGroupPercentage=1,"skuPricePercentageIncrease"===r.data.productBundleGroup.data.amountType?r.data.productBundleGroupPercentage=1+r.data.productBundleGroup.data.amount/100:"skuPricePercentageDecrease"===r.data.productBundleGroup.data.amountType&&(r.data.productBundleGroupPercentage=1-r.data.productBundleGroup.data.amount/100)})})}}}}}]),angular.module("slatwalladmin").directive("swOrderItem",["$log","$compile","$http","$templateCache","$slatwall","partialsPath",function(e,t,r,i,o,l){return{restrict:"A",scope:{orderItem:"=",orderId:"@",attributes:"="},templateUrl:l+"orderitem.html",link:function(t,r,i){e.debug("order item init"),e.debug(t.orderItem),t.orderItem.clicked=!1,t.orderItem.details=[],t.orderItem.events=[],t.orderItem.queuePosition,t.orderItem.onWaitlist=!1,t.orderItem.isPending=!1,t.orderItem.isRegistered=!1;if("event"===t.orderItem.data.sku.data.product.data.productType.data.systemCode){var l=t.orderItem.$$getEventRegistrations();l.then(function(){angular.forEach(t.orderItem.data.eventRegistrations,function(r){e.debug(r);var i=r.$$getEventRegistrationStatusType();i.then(function(r){e.debug(r),angular.forEach(r.records,function(r){e.debug("Records"),e.debug(r.eventRegistrationStatusType),angular.forEach(r.eventRegistrationStatusType,function(r){if(angular.isDefined(r.systemCode)&&null!==r.systemCode&&"erstWaitlisted"===r.systemCode){t.orderItem.onWaitlist=!0,e.debug("Found + "+r.systemCode);var i=n(t.orderItem);t.orderItem.queuePosition=i}else angular.isDefined(r.systemCode)&&null!==r.systemCode&&"erstRegistered"===r.systemCode?(t.orderItem.isRegistered=!0,e.debug("Found + "+r.systemCode)):angular.isDefined(r.systemCode)&&null!==r.systemCode&&"erstPendingApproval"===r.systemCode?(t.orderItem.isPending=!0,e.debug("Found + "+r.systemCode)):e.error("Couldn't resolve a status type for: "+r.systemCode)})})})})})}var n=function(r){e.debug("Retrieving position in Queue: ");var i=[{propertyIdentifier:"_eventregistration.waitlistQueuePositionStruct",isVisible:!0,persistent:!1,title:"Event Registrations"}],l=[{filterGroup:[{propertyIdentifier:"_eventregistration.orderItem.orderItemID",comparisonOperator:"=",value:r.$$getID()}]}],n={columnsConfig:angular.toJson(i),filterGroupsConfig:angular.toJson(l),allRecords:!0},a=o.getEntity("EventRegistration",n);e.debug(a),a.then(function(r){angular.forEach(r.records,function(r){return e.debug("Position: "+r.waitlistQueuePositionStruct),-1!==r.waitlistQueuePositionStruct?(t.orderItem.queuePosition=r.waitlistQueuePositionStruct,r.waitlistQueuePositionStruct):void 0})})},a=[{isDeletable:!1,isExportable:!0,propertyIdentifier:"_orderitem.orderItemID",ormtype:"id",isVisible:!0,isSearchable:!0,title:"Order Item ID"},{title:"Order Item Type",propertyIdentifier:"_orderitem.orderItemType",isVisible:!0,isDeletable:!0},{title:"Order Item Price",propertyIdentifier:"_orderitem.price",isVisible:!0,isDeletable:!0},{title:"Sku Name",propertyIdentifier:"_orderitem.sku.skuName",isVisible:!0,isDeletable:!0},{title:"Sku Price",propertyIdentifier:"_orderitem.skuPrice",isVisible:!0,isDeletable:!0},{title:"Sku ID",propertyIdentifier:"_orderitem.sku.skuID",isVisible:!0,isDeletable:!0},{title:"SKU Code",propertyIdentifier:"_orderitem.sku.skuCode",isVisible:!0,isDeletable:!0},{title:"Product Bundle Group",propertyIdentifier:"_orderitem.productBundleGroup.productBundleGroupID",isVisible:!0,isDeletable:!0},{title:"Product ID",propertyIdentifier:"_orderitem.sku.product.productID",isVisible:!0,isDeletable:!0},{title:"Product Name",propertyIdentifier:"_orderitem.sku.product.productName",isVisible:!0,isDeletable:!0},{title:"Product Type",propertyIdentifier:"_orderitem.sku.product.productType",isVisible:!0,isDeletable:!0},{title:"Product Description",propertyIdentifier:"_orderitem.sku.product.productDescription",isVisible:!0,isDeletable:!0},{propertyIdentifier:"_orderitem.sku.baseProductType",persistent:!1},{title:"Event Start Date",propertyIdentifier:"_orderitem.sku.eventStartDateTime",isVisible:!0,isDeletable:!0},{title:"Product Description",propertyIdentifier:"_orderitem.sku.options",isVisible:!0,isDeletable:!0},{propertyIdentifier:"_orderitem.sku.skuPrice",ormtype:"string"},{title:"Image File Name",propertyIdentifier:"_orderitem.sku.imageFile",isVisible:!0,isDeletable:!0},{title:"Qty.",propertyIdentifier:"_orderitem.quantity",isVisible:!0,isDeletable:!0},{title:"Fulfillment Method Name",propertyIdentifier:"_orderitem.orderFulfillment.fulfillmentMethod.fulfillmentMethodName",isVisible:!0,isDeletable:!0},{title:"Fulfillment ID",propertyIdentifier:"_orderitem.orderFulfillment.orderFulfillmentID",isVisible:!0,isDeletable:!0},{title:"Fulfillment Method Type",propertyIdentifier:"_orderitem.orderFulfillment.fulfillmentMethod.fulfillmentMethodType",isVisible:!0,isDeletable:!0},{propertyIdentifier:"_orderitem.orderFulfillment.pickupLocation.primaryAddress.address",isVisible:!0,isDeletable:!0},{title:"Street Address",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.streetAddress",isVisible:!0,isDeletable:!0},{title:"Street Address 2",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.street2Address",isVisible:!0,isDeletable:!0},{title:"Postal Code",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.postalCode",isVisible:!0,isDeletable:!0},{title:"City",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.city",isVisible:!0,isDeletable:!0},{title:"State",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.stateCode",isVisible:!0,isDeletable:!0},{title:"Country",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.countryCode",isVisible:!0,isDeletable:!0},{propertyIdentifier:"_orderitem.orderFulfillment.pickupLocation.primaryAddress.address",isVisible:!0,isDeletable:!0},{title:"Total",propertyIdentifier:"_orderitem.itemTotal",persistent:!1},{title:"Discount Amount",propertyIdentifier:"_orderitem.discountAmount",persistent:!1},{title:"Tax Amount",propertyIdentifier:"_orderitem.taxAmount",persistent:!1},{propertyIdentifier:"_orderitem.extendedPrice",persistent:!1},{propertyIdentifier:"_orderitem.productBundleGroup.amount",ormtype:"big_decimal"},{propertyIdentifier:"_orderitem.productBundleGroup.amountType",ormtype:"string"},{propertyIdentifier:"_orderitem.productBundleGroupPrice",persistent:!1},{propertyIdentifier:"_orderitem.productBundlePrice",persistent:!1}];angular.forEach(t.attributes,function(e){var t={propertyIdentifier:"_orderitem."+e.attributeCode,attributeID:e.attributeID,attributeSetObject:"orderItem"};a.push(t)});var d=[{filterGroup:[{propertyIdentifier:"_orderitem.parentOrderItem.orderItemID",comparisonOperator:"=",value:t.orderItem.$$getID()}]}],s={columnsConfig:angular.toJson(a),filterGroupsConfig:angular.toJson(d),allRecords:!0};t.childOrderItems=[],t.orderItem.depth=1,t.hideChildren=function(r){angular.forEach(t.childOrderItems,function(r){e.debug("hideing"),r.hide=!r.hide,t.orderItem.clicked=!t.orderItem.clicked})},t.deleteEntity=function(){e.debug("Deleting"),e.debug(t.orderItem);var r=t.orderItem.$$delete();r.then(function(){delete t.orderItem})},t.getChildOrderItems=function(){if(t.orderItem.childItemsRetrieved)angular.forEach(t.childOrderItems,function(e){e.hide=!e.hide,t.orderItem.clicked=!t.orderItem.clicked});else{t.orderItem.clicked=!t.orderItem.clicked,t.orderItem.hide=!t.orderItem.hide,t.orderItem.childItemsRetrieved=!0;var e=o.getEntity("orderItem",s);e.then(function(e){var r={};r.columns=a,r.baseEntityName="SlatwallOrderItem",r.baseEntityAlias="_orderitem";var i=o.populateCollection(e.records,r);angular.forEach(i,function(e){e.depth=t.orderItem.depth+1,t.childOrderItems.push(e),e.data.productBundleGroupPercentage=1,"skuPricePercentageIncrease"===e.data.productBundleGroup.data.amountType?e.data.productBundleGroupPercentage=1+e.data.productBundleGroup.data.amount/100:"skuPricePercentageDecrease"===e.data.productBundleGroup.data.amountType&&(e.data.productBundleGroupPercentage=1-e.data.productBundleGroup.data.amount/100)})})}}}}}]),angular.module("slatwalladmin").directive("swOrderItems",["$log","$timeout","$location","$slatwall","formService","partialsPath","paginationService",function(e,t,r,i,o,l,n){return{restrict:"E",scope:{orderId:"@"},templateUrl:l+"orderitemrows.html",link:function(r,o,l){r.currentPage=n.getCurrentPage(),r.pageShow=n.getPageShow(),r.pageStart=n.getPageStart,r.pageEnd=n.getPageEnd,r.recordsCount=n.getRecordsCount,r.autoScrollPage=1,r.autoScrollDisabled=!1,r.keywords="",r.loadingCollection=!1;var a;r.searchCollection=function(i){a&&t.cancel(a),a=t(function(){e.debug("search with keywords"),e.debug(r.keywords),n.setCurrentPage(1),r.loadingCollection=!0,r.getCollection()},500)},e.debug("Init Order Item"),e.debug(r.orderId),r.getCollection=function(){"Auto"===r.pageShow&&(r.pageShow=50);var t=[{isDeletable:!1,isExportable:!0,propertyIdentifier:"_orderitem.orderItemID",ormtype:"id",isVisible:!0,title:"Order Item ID",isSearchable:!0},{title:"Order Item Type",propertyIdentifier:"_orderitem.orderItemType",isVisible:!0},{title:"Order Item Price",propertyIdentifier:"_orderitem.price",isVisible:!0},{title:"Sku Name",propertyIdentifier:"_orderitem.sku.skuName",isVisible:!0,ormtype:"string",isSearchable:!0},{title:"Sku Price",propertyIdentifier:"_orderitem.skuPrice",isVisible:!0},{title:"Sku ID",propertyIdentifier:"_orderitem.sku.skuID",isVisible:!0},{title:"SKU Code",propertyIdentifier:"_orderitem.sku.skuCode",isVisible:!0,ormtype:"string",isSearchable:!0},{title:"Product Bundle Group",propertyIdentifier:"_orderitem.productBundleGroup.productBundleGroupID",isVisible:!0},{title:"Product ID",propertyIdentifier:"_orderitem.sku.product.productID",isVisible:!0},{title:"Product Name",propertyIdentifier:"_orderitem.sku.product.productName",isVisible:!0},{title:"Product Type",propertyIdentifier:"_orderitem.sku.product.productType",isVisible:!0},{propertyIdentifier:"_orderitem.sku.baseProductType",persistent:!1},{title:"Product Description",propertyIdentifier:"_orderitem.sku.product.productDescription",isVisible:!0},{title:"Event Start Date Time",propertyIdentifier:"_orderitem.sku.eventStartDateTime",isVisible:!0},{title:"Product Description",propertyIdentifier:"_orderitem.sku.options",isVisible:!0},{title:"Sku Location",propertyIdentifier:"_orderitem.sku.locations",isVisible:!0,persistent:!1},{title:"Subscription Term",propertyIdentifier:"_orderitem.sku.subscriptionTerm.subscriptionTermName",isVisible:!0},{title:"Subscription Benefits",propertyIdentifier:"_orderitem.sku.subscriptionBenefits",isVisible:!0},{title:"Qty.",propertyIdentifier:"_orderitem.quantity",isVisible:!0},{title:"Fulfillment Method Name",propertyIdentifier:"_orderitem.orderFulfillment.fulfillmentMethod.fulfillmentMethodName",isVisible:!0},{title:"Fulfillment ID",propertyIdentifier:"_orderitem.orderFulfillment.orderFulfillmentID",isVisible:!0},{title:"Fulfillment Method Type",propertyIdentifier:"_orderitem.orderFulfillment.fulfillmentMethod.fulfillmentMethodType",isVisible:!0},{title:"Street Address",propertyIdentifier:"_orderitem.orderFulfillment.pickupLocation.primaryAddress.address",isVisible:!0,ormtype:"string",isSearchable:!0},{title:"Street Address",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.streetAddress",isVisible:!0,ormtype:"string",isSearchable:!0},{title:"Street Address 2",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.street2Address",isVisible:!0,ormtype:"string",isSearchable:!0},{title:"Postal Code",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.postalCode",isVisible:!0,ormtype:"string",isSearchable:!0},{title:"City",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.city",isVisible:!0,ormtype:"string",isSearchable:!0},{title:"State",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.stateCode",isVisible:!0,ormtype:"string",isSearchable:!0},{title:"Country",propertyIdentifier:"_orderitem.orderFulfillment.shippingAddress.countryCode",isVisible:!0,ormtype:"string",isSearchable:!0},{title:"Image File Name",propertyIdentifier:"_orderitem.sku.imageFile",isVisible:!0},{title:"Total",propertyIdentifier:"_orderitem.itemTotal",persistent:!1},{title:"Discount Amount",propertyIdentifier:"_orderitem.discountAmount",persistent:!1},{title:"Tax Amount",propertyIdentifier:"_orderitem.taxAmount",persistent:!1},{propertyIdentifier:"_orderitem.extendedPrice",persistent:!1},{propertyIdentifier:"_orderitem.productBundlePrice",persistent:!1}];angular.forEach(r.attributes,function(e){var r={propertyIdentifier:"_orderitem."+e.attributeCode,attributeID:e.attributeID,attributeSetObject:"orderItem"};t.push(r)});var o=[{filterGroup:[{propertyIdentifier:"_orderitem.order.orderID",comparisonOperator:"=",value:r.orderId},{logicalOperator:"AND",propertyIdentifier:"_orderitem.parentOrderItem",comparisonOperator:"is",value:"null"}]}],l={columnsConfig:angular.toJson(t),filterGroupsConfig:angular.toJson(o),currentPage:r.currentPage,pageShow:r.pageShow,keywords:r.keywords};r.orderAttributes=[],r.attributeValues=[];var n=i.getEntity("orderItem",l);n.then(function(o){r.collection=o;var l={};l.columns=t,l.baseEntityName="SlatwallOrderItem",l.baseEntityAlias="_orderitem",r.orderItems=i.populateCollection(o.pageRecords,l);for(var n in r.orderItems)e.debug("OrderItem Product Type"),e.debug(r.orderItems);r.loadingCollection=!1})};var d=[{propertyIdentifier:"_attribute.attributeID",ormtype:"id",title:"attributeID"},{propertyIdentifier:"_attribute.attributeCode",ormtype:"string",title:"Attribute Code"},{propertyIdentifier:"_attribute.attributeName",ormtype:"string",title:"Attribute Name"}],s=[{filterGroup:[{propertyIdentifier:"_attribute.displayOnOrderDetailFlag",comparisonOperator:"=",value:!0},{logicalOperator:"AND",propertyIdentifier:"_attribute.activeFlag",comparisonOperator:"=",value:!0}]}],u={columnsConfig:angular.toJson(d),filterGroupsConfig:angular.toJson(s),allRecords:!0},p=i.getEntity("attribute",u);p.then(function(e){r.attributes=[],angular.forEach(e.records,function(e){r.attributes.push(e)}),r.getCollection()}),r.appendToCollection=function(){if("Auto"===r.pageShow&&(e.debug("AppendToCollection"),r.autoScrollPage<r.collection.totalPages)){r.autoScrollDisabled=!0,r.autoScrollPage++;var t={};angular.extend(t,options),t.pageShow=50,t.currentPage=r.autoScrollPage;var o=i.getEntity("orderItem",t);o.then(function(e){r.collection.pageRecords=r.collection.pageRecords.concat(e.pageRecords),r.autoScrollDisabled=!1},function(e){})}}}}}]);
//# sourceMappingURL=all.min.js.map