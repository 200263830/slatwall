"use strict";angular.module("slatwalladmin",["ngSlatwall","ui.bootstrap","ngAnimate","ngRoute"]).config(["$provide","$logProvider","$filterProvider","$httpProvider","$routeProvider","$injector","$locationProvider","datepickerConfig","datepickerPopupConfig",function(e,t,n,a,r,o,i,l,s){l.showWeeks=!1,l.format="MMM dd, yyyy hh:mm a",s.toggleWeeksText=null,slatwallAngular.hashbang&&i.html5Mode(!1).hashPrefix("!"),e.constant("baseURL",$.slatwall.getConfig().baseURL);var u=$.slatwall.getConfig().baseURL+"/admin/client/partials/";e.constant("partialsPath",u),e.constant("productBundlePartialsPath",u+"productbundle/"),angular.forEach(slatwallAngular.constantPaths,function(t,n){var a=t.charAt(0).toLowerCase()+t.slice(1)+"PartialsPath",r=u+t.toLowerCase()+"/";e.constant(a,r)}),t.debugEnabled($.slatwall.getConfig().debugFlag),n.register("likeFilter",function(){return function(e){return angular.isDefined(e)&&angular.isString(e)?e.replace(new RegExp("%","g"),""):void 0}}),n.register("truncate",function(){return function(e,t,n){if(isNaN(t))return e;if(0>=t)return"";if(e&&e.length>t){if(e=e.substring(0,t),n)for(;" "===e.charAt(e.length-1);)e=e.substr(0,e.length-1);else{var a=e.lastIndexOf(" ");-1!==a&&(e=e.substr(0,a))}return e+"..."}return e}}),a.interceptors.push("slatwallInterceptor"),r.when("/entity/:entityName/",{template:function(e){var t=o.has("sw"+e.entityName+"ListDirective");return t?"<sw-"+e.entityName.toLowerCase()+"-list>":"<sw-list></sw-list>"},controller:"routerController"}).when("/entity/:entityName/:entityID",{template:function(e){var t=o.has("sw"+e.entityName+"DetailDirective");return t?"<sw-"+e.entityName.toLowerCase()+"-detail>":"<sw-detail></sw-detail>"},controller:"routerController"}).otherwise({templateUrl:$.slatwall.getConfig().baseURL+"/admin/client/js/partials/otherwise.html"})}]).run(["$rootScope","$filter","$anchorScroll","$slatwall","dialogService",function(e,t,n,a,r){n.yOffset=100,e.openPageDialog=function(e){r.addPageDialog(e)},e.closePageDialog=function(e){r.removePageDialog(e)},e.loadedResourceBundle=!1,e.loadedResourceBundle=a.hasResourceBundle();var o=e.$watch("loadedResourceBundle",function(t,n){t!==n&&(e.$broadcast("hasResourceBundle"),o())})}]).filter("entityRBKey",["$slatwall",function(e){return function(t){return angular.isDefined(t)&&angular.isString(t)?(t=t.replace("_","").toLowerCase(),t=e.getRBKey("entity."+t)):void 0}}]),angular.module("slatwalladmin").factory("alertService",["$timeout",function(e){var t=[],n={addAlert:function(n){t.push(n),e(function(){t.splice(0,1)},3500)},addAlerts:function(n){for(var a in n)t.push(n[a]),e(function(){t.splice(0,1)},3500)},formatMessagesToAlerts:function(t){var n=[];for(var a in t){var r={msg:t[a].message,type:t[a].messageType};n.push(r),"success"===r.type||"error"===r.type?(e(function(){r.fade=!0},3500),r.dismissable=!1):(r.fade=!1,r.dismissable=!0)}return n},getAlerts:function(){return t},removeAlert:function(e){for(var n in t)t[n]===e&&delete t[n]},removeOldestAlert:function(){_alert.splice(0,1)}};return n}]),angular.module("slatwalladmin").factory("collectionService",["$filter","$log",function(e,t){var n=null,a={},r=0,o=e("orderBy"),i={setFilterCount:function(e){t.debug("incrementFilterCount"),r=e},getFilterCount:function(){return r},getColumns:function(){return n.collectionConfig.columns},getFilterPropertiesList:function(){return a},getFilterPropertiesListByBaseEntityAlias:function(e){return a[e]},setFilterPropertiesList:function(e,t){angular.isUndefined(a[t])&&(a[t]=e)},stringifyJSON:function(e){var t=angular.toJson(e);return t},removeFilterItem:function(e,t){t.pop(t.indexOf(e))},selectFilterItem:function(e){if(e.$$isClosed){for(var t in e.$$siblingItems)e.$$siblingItems[t].$$isClosed=!0,e.$$siblingItems[t].$$disabled=!0;e.$$isClosed=!1,e.$$disabled=!1,e.setItemInUse(!0)}else{for(var t in e.$$siblingItems)e.$$siblingItems[t].$$disabled=!1;e.$$isClosed=!0,e.setItemInUse(!1)}},selectFilterGroupItem:function(e){if(e.$$isClosed){for(var t in e.$$siblingItems)e.$$siblingItems[t].$$disabled=!0;e.$$isClosed=!1,e.$$disabled=!1}else{for(var t in e.$$siblingItems)e.$$siblingItems[t].$$disabled=!1;e.$$isClosed=!0}e.setItemInUse(!e.$$isClosed)},newFilterItem:function(e,t,n){angular.isUndefined(n)&&(n=!1);var a={displayPropertyIdentifier:"",propertyIdentifier:"",comparisonOperator:"",value:"",$$disabled:!1,$$isClosed:!0,$$isNew:!0,$$siblingItems:e,setItemInUse:t};0!==e.length&&(a.logicalOperator="AND"),n===!0&&(a.$$prepareForFilterGroup=!0),e.push(a),this.selectFilterItem(a)},newFilterGroupItem:function(e,t){var n={filterGroup:[],$$disabled:"false",$$isClosed:"true",$$siblingItems:e,$$isNew:"true",setItemInUse:t};0!==e.length&&(n.logicalOperator="AND"),e.push(n),i.selectFilterGroupItem(n),this.newFilterItem(n.filterGroup,t)},transplantFilterItemIntoFilterGroup:function(e,t){var n={filterGroup:[],$$disabled:"false",$$isClosed:"true",$$isNew:"true"};angular.isDefined(t.logicalOperator)&&(n.logicalOperator=t.logicalOperator,delete t.logicalOperator),n.setItemInUse=t.setItemInUse,n.$$siblingItems=t.$$siblingItems,t.$$siblingItems=[],e.pop(e.indexOf(t)),t.$$prepareForFilterGroup=!1,n.filterGroup.push(t),e.push(n)},formatFilterPropertiesList:function(e,n){t.debug("format Filter Properties List arguments 2"),t.debug(e),t.debug(n);var a={$$group:"simple",displayPropertyIdentifier:"-----------------"};e.data.push(a);var r={$$group:"drilldown",displayPropertyIdentifier:"-----------------"};e.data.push(r);var i={$$group:"compareCollections",displayPropertyIdentifier:"-----------------"};e.data.push(i);var l={$$group:"attribute",displayPropertyIdentifier:"-----------------"};e.data.push(l);for(var s in e.data)angular.isDefined(e.data[s].ormtype)&&(e.data[s].$$group=angular.isDefined(e.data[s].attributeID)?"attribute":"simple"),angular.isDefined(e.data[s].fieldtype)&&("id"===e.data[s].fieldtype&&(e.data[s].$$group="simple"),"many-to-one"===e.data[s].fieldtype&&(e.data[s].$$group="drilldown"),("many-to-many"===e.data[s].fieldtype||"one-to-many"===e.data[s].fieldtype)&&(e.data[s].$$group="compareCollections")),e.data[s].propertyIdentifier=n+"."+e.data[s].name;e.data=o(e.data,["-$$group","propertyIdentifier"],!1)},orderBy:function(e,t,n){return o(e,t,n)}};return i}]),angular.module("slatwalladmin").factory("dialogService",["partialsPath",function(e){var t=[],n={addPageDialog:function(n){var a={path:e+n+".html"};t.push(a)},removePageDialog:function(e){t.splice(e,1)},getPageDialogs:function(){return t}};return n}]),angular.module("slatwalladmin").factory("formService",["$log",function(e){function t(e,t,n){this.name=e,this.object=t,this.editing=n}var n={},a={},r={setPristinePropertyValue:function(e,t){a[e]=t},getPristinePropertyValue:function(e){return a[e]},clearForm:function(t){e.debug("clear form"),e.debug(t);for(var n in t)"$"!==n.charAt(0)&&e.debug(t[n])},setForm:function(e){n[e.name]=e},getForm:function(e){return n[e]},getForms:function(){return n},getFormsByObjectName:function(e){var t=[];for(var a in n)angular.isDefined(n[a].$$swFormInfo.object)&&n[a].$$swFormInfo.object.metaData.className===e&&t.push(n[a]);return t},createForm:function(e,n,a){var r=new t(e,n,a);return this.setForm(r),r},resetForm:function(e){for(var t in e)"$"!==t.charAt(0)&&(e[t].$setViewValue(angular.isDefined(this.getPristinePropertyValue(t))?this.getPristinePropertyValue(t):""),e[t].$render());e.$submitted=!1,e.$setPristine()}};return r}]),angular.module("slatwalladmin").factory("metadataService",["$filter","$log",function(e,t){var n={},a=e("orderBy"),r={getPropertiesList:function(){return n},getPropertiesListByBaseEntityAlias:function(e){return n[e]},setPropertiesList:function(e,t){n[t]=e},formatPropertiesList:function(e,n){var r={$$group:"simple"};e.data.push(r);var o={$$group:"drilldown"};e.data.push(o);var i={$$group:"compareCollections"};e.data.push(i);var l={$$group:"attribute"};e.data.push(l);for(var s in e.data)angular.isDefined(e.data[s].ormtype)&&(e.data[s].$$group=angular.isDefined(e.data[s].attributeID)?"attribute":"simple"),angular.isDefined(e.data[s].fieldtype)&&("id"===e.data[s].fieldtype&&(e.data[s].$$group="simple"),"many-to-one"===e.data[s].fieldtype&&(e.data[s].$$group="drilldown"),("many-to-many"===e.data[s].fieldtype||"one-to-many"===e.data[s].fieldtype)&&(e.data[s].$$group="compareCollections")),e.data[s].propertyIdentifier=n+"."+e.data[s].name;for(var u=[],s=0;s<=e.data.length-1;s++)-1!=e.data[s].propertyIdentifier.indexOf(".undefined")?(t.debug("removing: "+e.data[s].displayPropertyIdentifier),e.data[s].displayPropertyIdentifier="hide"):(u.push(e.data[s]),t.debug(e.data[s]));u.sort,e.data=u,t.debug("----------------------PropertyList\n\n\n\n\n"),e.data=a(e.data,["propertyIdentifier"],!1)},orderBy:function(e,t,n){return a(e,t,n)}};return r}]),angular.module("slatwalladmin").factory("paginationService",[function(){var e=[{display:10,value:10},{display:20,value:20},{display:50,value:50},{display:250,value:250},{display:"Auto",value:"Auto"}],t=10,n=1,a=0,r=0,o=0,i=0,l={getTotalPages:function(){return i},setTotalPages:function(e){i=e},getPageStart:function(){return a},setPageStart:function(e){a=e},getPageEnd:function(){return r},setPageEnd:function(e){r=e},getRecordsCount:function(){return o},setRecordsCount:function(e){o=e},getPageShowOptions:function(){return e},setPageShowOptions:function(t){e=t},getPageShow:function(){return t},setPageShow:function(e){t=e},getCurrentPage:function(){return n},setCurrentPage:function(e){n=e},previousPage:function(){this.hasPrevious()||(n=this.getCurrentPage()-1)},nextPage:function(){this.hasNext()||(n=this.getCurrentPage()+1)},hasPrevious:function(){return l.getPageStart()<=1?!0:!1},hasNext:function(){return l.getPageEnd()===l.getRecordsCount()?!0:!1}};return l}]),angular.module("slatwalladmin").controller("alertController",["$scope","alertService",function(e,t){e.$id="alertController",e.alerts=t.getAlerts()}]),angular.module("slatwalladmin").controller("collections",["$scope","$location","$log","$timeout","$slatwall","collectionService","metadataService","paginationService",function(e,t,n,a,r,o,i,l){e.$id="collectionsController";var s=function(){for(var e={},t=window.location.search.substring(1),n=t.split("&"),a=0;a<n.length;a++){var r=n[a].split("=");if("undefined"==typeof e[r[0]])e[r[0]]=r[1];else if("string"==typeof e[r[0]]){var o=[e[r[0]],r[1]];e[r[0]]=o}else e[r[0]].push(r[1])}return e}();e.collectionID=s.collectionID,e.currentPage=l.getCurrentPage(),e.pageShow=l.getPageShow(),e.pageStart=l.getPageStart,e.pageEnd=l.getPageEnd,e.recordsCount=l.getRecordsCount,e.autoScrollPage=1,e.autoScrollDisabled=!1,e.appendToCollection=function(){if("Auto"===e.pageShow&&(n.debug("AppendToCollection"),e.autoScrollPage<e.collection.totalPages)){e.autoScrollDisabled=!0,e.autoScrollPage++;var t=r.getEntity("collection",{id:e.collectionID,currentPage:e.autoScrollPage,pageShow:50});t.then(function(t){e.collection.pageRecords=e.collection.pageRecords.concat(t.pageRecords),e.autoScrollDisabled=!1},function(e){})}},e.keywords="",e.loadingCollection=!1;var u;e.searchCollection=function(t){u&&a.cancel(u),u=a(function(){n.debug("search with keywords"),n.debug(e.keywords),l.setCurrentPage(1),e.loadingCollection=!0,e.getCollection()},500)},e.getCollection=function(){var t=50;"Auto"!==e.pageShow&&(t=e.pageShow);var n=r.getEntity("collection",{id:e.collectionID,currentPage:e.currentPage,pageShow:t,keywords:e.keywords});n.then(function(t){e.collection=t,e.collectionInitial=angular.copy(e.collection),angular.isUndefined(e.collectionConfig)&&(e.collectionConfig=angular.fromJson(e.collection.collectionConfig)),angular.isUndefined(e.collectionConfig.filterGroups)&&(e.collectionConfig.filterGroups=[{filterGroup:[]}]),o.setFilterCount(d()),e.loadingCollection=!1},function(e){})},e.getCollection();var c=e.$watch("collection",function(t,n){if(t!==n){if(angular.isUndefined(e.filterPropertiesList)){e.filterPropertiesList={};var a=r.getFilterPropertiesByBaseEntityName(e.collectionConfig.baseEntityAlias);a.then(function(t){i.setPropertiesList(t,e.collectionConfig.baseEntityAlias),e.filterPropertiesList[e.collectionConfig.baseEntityAlias]=i.getPropertiesListByBaseEntityAlias(e.collectionConfig.baseEntityAlias),i.formatPropertiesList(e.filterPropertiesList[e.collectionConfig.baseEntityAlias],e.collectionConfig.baseEntityAlias)})}c()}});e.setCollectionForm=function(t){e.collectionForm=t},e.collectionDetails={isOpen:!1,openCollectionDetails:function(){e.collectionDetails.isOpen=!0}},e.errorMessage={};var d=function(t){var n=0;angular.isDefined(t)||(t=e.collectionConfig.filterGroups[0].filterGroup);for(var a in t)if(t[a].$$isNew||angular.isDefined(t[a].filterGroup)){if(!angular.isDefined(t[a].filterGroup))break;n+=d(t[a].filterGroup)}else n++;return n};e.saveCollection=function(){a(function(){n.debug("saving Collection");var t="collection",a=e.collection;if(n.debug(e.collectionConfig),p(e.collectionForm)){var i=o.stringifyJSON(e.collectionConfig);n.debug(i);var s=angular.copy(a);s.collectionConfig=i,delete s.pageRecords;var u=r.saveEntity(t,a.collectionID,s);u.then(function(t){e.errorMessage={},l.setCurrentPage(1),e.getCollection(),e.collectionDetails.isOpen=!1},function(t){angular.forEach(t.errors,function(t,n){e.collectionForm[n].$invalid=!0,e.errorMessage[n]=t[0]})})}o.setFilterCount(d())})};var p=function(t){n.debug("validateForm");var a=!0;for(var r in t)if("$"!=r[0]){if(t[r].$invalid){a=!1;for(var o in t[r].$error)"required"==o&&(e.errorMessage[r]="This field is required")}t[r].$pristine&&t[r].$setViewValue(angular.isUndefined(t[r].$viewValue)?"":t[r].$viewValue)}return a};e.copyExistingCollection=function(){e.collection.collectionConfig=e.selectedExistingCollection},e.setSelectedExistingCollection=function(t){e.selectedExistingCollection=t},e.setSelectedFilterProperty=function(t){e.selectedFilterProperty=t},e.filterCount=o.getFilterCount}]),angular.module("slatwalladmin").controller("collectionsTabController",["$scope",function(e){}]),angular.module("slatwalladmin").controller("confirmationController",["$scope","$log","$modalInstance",function(e,t,n){e.deleteEntity=function(n){t.debug("Deleting an entity."),t.debug(e.entity),this.close()},e.close=function(){n.close()},e.cancel=function(){n.dismiss("cancel")}}]),angular.module("slatwalladmin").controller("create-bundle-controller",["$scope","$location","$log","$rootScope","$window","$slatwall","dialogService","alertService","productBundleService","formService","partialsPath",function(e,t,n,a,r,o,i,l,s,u,c){function d(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}e.partialsPath=c,e.$id="create-bundle-controller",angular.isDefined(e.scrollToTopOfDialog)&&e.scrollToTopOfDialog();var p=d("productID"),g=function(){e.product=o.newProduct();var t=o.newBrand(),n=o.newProductType();e.product.$$setBrand(t),e.product.$$setProductType(n),e.product.$$addSku(),e.product.data.skus[0].data.productBundleGroups=[]};if(e.productBundleGroup,angular.isDefined(p)&&""!==p){var f=o.getProduct({id:p});f.promise.then(function(){n.debug(f.value),f.value.$$getSkus().then(function(){f.value.data.skus[0].$$getProductBundleGroups().then(function(){e.product=f.value,angular.forEach(e.product.data.skus[0].data.productBundleGroups,function(e){e.$$getProductBundleGroupType(),s.decorateProductBundleGroup(e),e.data.$$editing=!1})})})},g())}else g();e.saveProductBundle=function(t){e.newSaving=!0,n.debug(e.newSaving),e.dIndex=t,e.product.$$save().then(function(){n.debug("Turn off the loader after saving."),e.newSaving=!1,angular.isDefined(e.dIndex)&&(e.closeSaving=!0,a.closePageDialog(e.dIndex))})}}]),angular.module("slatwalladmin").controller("globalSearch",["$scope","$log","$window","$timeout","$slatwall",function(e,t,n,a,r){e.keywords="",e.searchResultsOpen=!1,e.sidebarClass="sidebar",e.loading=!1,e.resultsFound=!0,e.searchResults={product:{title:"Products",resultNameFilter:function(e){return e.productName},results:[],id:function(e){return e.productID}},brand:{title:r.getRBKey("entity.Brands"),resultNameFilter:function(e){return e.brandName},results:[],id:function(e){return e.brandID}},account:{title:"Accounts",resultNameFilter:function(e){return e.firstName+" "+e.lastName},results:[],id:function(e){return e.accountID}},vendor:{title:"Vendors",resultNameFilter:function(e){return e.vendorName},results:[],id:function(e){return e.vendorID}}};var o,i=0;e.updateSearchResults=function(){e.loading=!0,e.showResults(),o&&a.cancel(o),o=a(function(){if(""===e.keywords)e.hideResults();else{e.showResults(),i=Object.keys(e.searchResults).length;for(var t in e.searchResults)(function(t){var n=r.getEntity(t,{keywords:e.keywords,pageShow:4,deferkey:"global-search-"+t});n.then(function(n){e.searchResults[t].results=[],e.searchResults[t].title=r.getRBKey("entity."+t.toLowerCase()+"_plural");for(var a in n.pageRecords)e.searchResults[t].results.push({name:e.searchResults[t].resultNameFilter(n.pageRecords[a]),link:"?slatAction=entity.detail"+t+"&"+t+"ID="+e.searchResults[t].id(n.pageRecords[a])});if(i--,0==i){e.loading=!1;var o=!1;for(var l in e.searchResults)if(e.searchResults[l].results.length){o=!0;break}e.resultsFound=o}})})(t)}},500)},e.showResults=function(){e.searchResultsOpen=!0,e.sidebarClass="sidebar s-search-width",n.onclick=function(t){var n=t.target.parentElement.offsetParent.classList.contains("sidebar");n||(e.hideResults(),e.$apply())}},e.hideResults=function(){e.searchResultsOpen=!1,e.sidebarClass="sidebar",e.search.$setPristine(),e.keywords="",n.onclick=null,e.loading=!1,e.resultsFound=!0;for(var t in e.searchResults)e.searchResults[t].results=[]}}]),angular.module("slatwalladmin").controller("pageDialog",["$scope","$location","$log","$anchorScroll","$slatwall","dialogService",function(e,t,n,a,r,o){e.$id="pageDialogController",e.pageDialogs=o.getPageDialogs(),e.scrollToTopOfDialog=function(){t.hash("/#topOfPageDialog"),a()},e.pageDialogStyle={"z-index":3e3}}]),angular.module("slatwalladmin").controller("preprocessaccount_addaccountpayment",["$scope","$compile",function(e,t){var n={aptCharge:"444df32dd2b0583d59a19f1b77869025",aptCredit:"444df32e9b448ea196c18c66e1454c46",aptAdjustment:"68e3fb57d8102b47acc0003906d16ddd"};e.totalAmountToApply=0,e.paymentTypeName=$.slatwall.rbKey("define.charge"),e.paymentTypeLock=!0,e.amount=0,e.updatePaymentType=function(){angular.forEach(e.appliedOrderPayment,function(t,a){e.paymentType!=n.aptAdjustment&&(t.paymentType=e.paymentType)}),e.paymentType==n.aptCharge?(e.paymentTypeName=$.slatwall.rbKey("define.charge"),e.paymentTypeLock=!0):e.paymentType==n.aptCredit?(e.paymentTypeName=$.slatwall.rbKey("define.credit"),e.paymentTypeLock=!0):e.paymentType==n.aptAdjustment&&(e.paymentTypeLock=!1,e.paymentTypeName=$.slatwall.rbKey("define.adjustment"),e.amount=0),e.updateSubTotal()},e.updateSubTotal=function(){e.totalAmountToApply=0,angular.forEach(e.appliedOrderPayment,function(t,a){void 0==t.amount||isNaN(t.amount)||(e.paymentType==n.aptCharge||e.paymentType==n.aptAdjustment?t.paymentType==n.aptCharge?e.totalAmountToApply+=parseFloat(t.amount):t.paymentType==n.aptCredit&&(e.totalAmountToApply-=parseFloat(t.amount)):e.paymentType==n.aptCredit&&(t.paymentType==n.aptCharge?e.totalAmountToApply-=parseFloat(t.amount):t.paymentType==n.aptCredit&&(e.totalAmountToApply+=parseFloat(t.amount))))}),e.amountUnapplied=Math.round(100*(e.amount-e.totalAmountToApply))/100,e.accountBalanceChange=parseFloat(e.amount),e.paymentType==n.aptCharge?e.accountBalanceChange=parseFloat(-1*e.accountBalanceChange):e.paymentType==n.aptAdjustment&&(e.accountBalanceChange+=parseFloat(e.amountUnapplied))}}]),angular.module("slatwalladmin").controller("routerController",["$scope","$routeParams","$location","$log","partialsPath","baseURL",function(e,t,n,a,r,o){e.$id="routerController",e.partialRoute="",a.debug(t),a.debug(n);var i=n.path();e.controllerType=i.split("/")[1];"entity"===e.controllerType&&(e.entityName=t.entityName,angular.isDefined(t.entityID)&&(e.entityID=t.entityID||""))}]);
//# sourceMappingURL=all.min.js.map