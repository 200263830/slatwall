{"version":3,"names":[],"mappings":"","sources":["model/collectionConfig.js"],"sourcesContent":["var slatwalladmin;\n(function (slatwalladmin) {\n    class Column {\n        constructor(propertyIdentifier, title, isVisible, isDeletable, attributeID, attributeSetObject) {\n            this.propertyIdentifier = propertyIdentifier;\n            this.title = title;\n            this.isVisible = isVisible;\n            this.isDeletable = isDeletable;\n            this.attributeID = attributeID;\n            this.attributeSetObject = attributeSetObject;\n        }\n    }\n    class FilterGroup {\n        constructor(filterGroups) {\n            this.filterGroups = filterGroups;\n        }\n    }\n    class Filter {\n        constructor(propertyIdentifier, value, comparisonOperator, logicalOperator) {\n            this.propertyIdentifier = propertyIdentifier;\n            this.value = value;\n            this.comparisonOperator = comparisonOperator;\n            this.logicalOperator = logicalOperator;\n        }\n    }\n    class Join {\n        constructor(associationName, alias) {\n            this.associationName = associationName;\n            this.alias = alias;\n        }\n    }\n    class OrderBy {\n        constructor(propertyIdentifier, direction) {\n            this.propertyIdentifier = propertyIdentifier;\n            this.direction = direction;\n        }\n    }\n    class CollectionConfig {\n        constructor($slatwall, baseEntityName, baseEntityAlias, columns, filterGroups = [], joins, orderBy, currentPage = 1, pageShow = 10, keywords = '') {\n            this.$slatwall = $slatwall;\n            this.baseEntityName = baseEntityName;\n            this.baseEntityAlias = baseEntityAlias;\n            this.columns = columns;\n            this.filterGroups = filterGroups;\n            this.joins = joins;\n            this.orderBy = orderBy;\n            this.currentPage = currentPage;\n            this.pageShow = pageShow;\n            this.keywords = keywords;\n        }\n        loadJson(jsonCollection) {\n            //if json then make a javascript object else use the javascript object\n            if (angular.isString(jsonCollection)) {\n                jsonCollection = angular.fromJson(jsonCollection);\n            }\n            this.baseEntityAlias = jsonCollection.baseEntityAlias;\n            this.baseEntityName = jsonCollection.baseEntityName;\n            this.columns = jsonCollection.columns;\n            this.currentPage = jsonCollection.currentPage;\n            this.filterGroups = jsonCollection.filterGroups;\n            this.joins = jsonCollection.joins;\n            this.keywords = jsonCollection.keywords;\n            this.orderBy = jsonCollection.orderBy;\n            this.pageShow = jsonCollection.pageShow;\n        }\n        getJson() {\n            var config = this;\n            delete config['$slatwall'];\n            //config.filterGroups= [{'filterGroup': this.filterGroups}];\n            return angular.toJson(config);\n        }\n        getEntityName() {\n            return this.baseEntityName.charAt(0).toUpperCase() + this.baseEntityName.slice(1);\n        }\n        getOptions() {\n            return {\n                columnsConfig: angular.toJson(this.columns),\n                filterGroupsConfig: angular.toJson([{ 'filterGroup': this.filterGroups }]),\n                joinsConfig: angular.toJson(this.joins),\n                currentPage: this.currentPage,\n                pageShow: this.pageShow,\n                keywords: this.keywords\n            };\n        }\n        debug() {\n            return this;\n        }\n        formatCollectionName(propertyIdentifier, property = true) {\n            var collection = '';\n            var parts = propertyIdentifier.split('.');\n            for (var i = 0; i < parts.length; i++) {\n                if (typeof this.$slatwall['new' + this.capitalize(parts[i])] !== \"function\") {\n                    if (property)\n                        collection += ((i) ? '' : this.baseEntityAlias) + '.' + parts[i];\n                    break;\n                }\n                collection += '_' + parts[i].toLowerCase();\n            }\n            return collection;\n        }\n        addJoin(associationName) {\n            var joinFound = false;\n            if (angular.isUndefined(this.columns)) {\n                this.joins = [];\n            }\n            var parts = associationName.split('.');\n            var collection = '';\n            for (var i = 0; i < parts.length; i++) {\n                joinFound = false;\n                if (typeof this.$slatwall['new' + this.capitalize(parts[i])] !== \"function\")\n                    break;\n                collection += '.' + parts[i];\n                this.joins.map(function (_join) {\n                    if (_join.associationName == collection.slice(1)) {\n                        joinFound = true;\n                        return;\n                    }\n                });\n                if (!joinFound) {\n                    this.joins.push(new Join(collection.slice(1), collection.toLowerCase().replace(/\\./g, '_')));\n                }\n            }\n        }\n        addAlias(propertyIdentifier) {\n            var parts = propertyIdentifier.split('.');\n            if (parts.length > 1 && parts[0] !== this.baseEntityAlias) {\n                return this.baseEntityAlias + '.' + propertyIdentifier;\n            }\n            return propertyIdentifier;\n        }\n        capitalize(s) {\n            return s && s[0].toUpperCase() + s.slice(1);\n        }\n        addColumn(column, title = '', options = {}) {\n            var isVisible = true;\n            var isDeletable = true;\n            if (angular.isUndefined(this.columns)) {\n                this.columns = [];\n            }\n            if (!angular.isUndefined(options['isVisible'])) {\n                isVisible = options['isVisible'];\n            }\n            if (!angular.isUndefined(options['isDeletable'])) {\n                isDeletable = options['isDeletable'];\n            }\n            this.columns.push(new Column(column, title, isVisible, isDeletable, options['attributeID'], options['attributeSetObject']));\n        }\n        setDisplayProperties(propertyIdentifier, title = '', options = {}) {\n            var _DividedColumns = propertyIdentifier.trim().split(',');\n            var _DividedTitles = title.trim().split(',');\n            if (_DividedColumns.length > 0) {\n                _DividedColumns.forEach((column, index) => {\n                    column = column.trim();\n                    this.addJoin(column);\n                    if (_DividedTitles[index] !== undefined && _DividedTitles[index] != '') {\n                        title = _DividedTitles[index].trim();\n                    }\n                    else {\n                        var startAlias = new RegExp('^' + this.baseEntityAlias + '\\\\.');\n                        title = column.replace(startAlias, '').replace(/\\./g, '_');\n                    }\n                    this.addColumn(this.formatCollectionName(column), title, options);\n                });\n            }\n            else {\n                this.addJoin(propertyIdentifier);\n                propertyIdentifier = this.addAlias(propertyIdentifier);\n                if (title == '')\n                    title = propertyIdentifier.trim().replace(this.baseEntityAlias + '.', '').replace(/\\./g, '_');\n                this.addColumn(this.formatCollectionName(propertyIdentifier), title, options);\n            }\n        }\n        addFilter(propertyIdentifier, value, comparisonOperator = '=', logicalOperator = '') {\n            this.addJoin(propertyIdentifier);\n            this.filterGroups.push(new Filter(this.formatCollectionName(propertyIdentifier), value, comparisonOperator, logicalOperator));\n        }\n        setOrderBy(propertyIdentifier, direction = 'DESC') {\n            if (angular.isUndefined(this.orderBy)) {\n                this.orderBy = [];\n            }\n            this.addJoin(propertyIdentifier);\n            this.orderBy.push(new OrderBy(this.formatCollectionName(propertyIdentifier), direction));\n        }\n        setCurrentPage(pageNumber) {\n            this.currentPage = pageNumber;\n        }\n        setPageShow(NumberOfPages) {\n            this.pageShow = NumberOfPages;\n        }\n        setKeywords(keyword) {\n            this.keywords = keyword;\n        }\n    }\n    slatwalladmin.CollectionConfig = CollectionConfig;\n})(slatwalladmin || (slatwalladmin = {}));\n\n//# sourceMappingURL=../model/collectionConfig.js.map"],"file":"model/collectionConfig.js","sourceRoot":"/source/"}